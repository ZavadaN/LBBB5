Adam = ADAptive Moment Estimation

Adam - –∞–¥–∞–ø—Ç–∏–≤–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –º–æ–º–µ–Ω—Ç–∞. –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–≤–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–∫–æ–ª—å–∑—è—â–µ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ:

ùë£
 ‚Äì –ø–µ—Ä–≤—ã–π –º–æ–º–µ–Ω—Ç ùë†
 ‚Äì –≤—Ç–æ—Ä–æ–π –º–æ–º–µ–Ω—Ç –ê–ª–≥–æ—Ä–∏—Ç–º –≤—ã—á–∏—Å–ª—è–µ—Ç —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –≤–∑–≤–µ—à–µ–Ω–Ω–æ–µ —Å—Ä–µ–¥–Ω–µ–µ –ø—Ä–æ—à–ª—ã—Ö –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ –∏ –∏—Ö –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤. –≠—Ç–∏ —Å–∫–æ–ª—å–∑—è—â–∏–µ —Å—Ä–µ–¥–Ω–∏–µ –∑–∞—Ç–µ–º –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–æ–¥–µ–ª–∏.

–ê–ª–≥–æ—Ä–∏—Ç–º –ê–¥–∞–º–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö —à–∞–≥–æ–≤:

–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö. –ê–ª–≥–æ—Ä–∏—Ç–º –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–∫–æ–ª—å–∑—è—â–µ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ ùë£
 –∏ ùë†
 - —Å–ª–æ–≤–∞—Ä–µ–π –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –≤–∑–≤–µ—à–µ–Ω–Ω—ã—Ö —Å—Ä–µ–¥–Ω–∏—Ö –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ –∏ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ.

–í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å–∫–æ–ª—å–∑—è—â–∏—Ö —Å—Ä–µ–¥–Ω–∏—Ö. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –º–æ–¥–µ–ª–∏ –∞–ª–≥–æ—Ä–∏—Ç–º –≤—ã—á–∏—Å–ª—è–µ—Ç —Å–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ –ø—É—Ç–µ–º –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º —Å–∫–æ–ª—å–∑—è—â–∏–º —Å—Ä–µ–¥–Ω–∏–º. –¢–∞–∫–∂–µ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è —Å–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤. –ö–æ—Ä—Ä–µ–∫—Ü–∏—è —Å–º–µ—â–µ–Ω–∏—è. –ß—Ç–æ–±—ã —É–º–µ–Ω—å—à–∏—Ç—å —Å–º–µ—â–µ–Ω–∏–µ –≤–æ –≤—Ä–µ–º—è –Ω–∞—á–∞–ª—å–Ω—ã—Ö –∏—Ç–µ—Ä–∞—Ü–∏–π, Adam –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ü–∏—é —Å–º–µ—â–µ–Ω–∏—è –ø—É—Ç–µ–º –¥–µ–ª–µ–Ω–∏—è —Å–∫–æ–ª—å–∑—è—â–∏—Ö —Å—Ä–µ–¥–Ω–∏—Ö –Ω–∞ –ø–æ–ø—Ä–∞–≤–æ—á–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤. –ê–ª–≥–æ—Ä–∏—Ç–º –æ–±–Ω–æ–≤–ª—è–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏, –∏—Å–ø–æ–ª—å–∑—É—è —Å–∫–æ–ª—å–∑—è—â–∏–µ —Å—Ä–µ–¥–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ –∏ –∫–≤–∞–¥—Ä–∞—Ç—ã –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤.

ùë†ùë°ùë£ùë°ùë†ùë°^ùë£ùë°^ùë§ùë°+1=ùõΩ1ùë†ùë°‚àí1+(1‚ÄìùõΩ1)‚àáùë§ùë°=ùõΩ2ùë£ùë°‚àí1+(1‚ÄìùõΩ2)(‚àáùë§ùë°)2=ùë†ùë°1‚ÄìùõΩ1ùë°=ùë£ùë°1‚ÄìùõΩ2ùë°=ùë§ùë°‚Äìùõºùë†ùë°^ùë£ùë°^+ùúñ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚éØ‚àö
ùë§ùë°
 - –≤–µ—Å–∞ –º–æ–¥–µ–ª–∏;

learning_rate (ùõº
) - —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è;

ùõΩ1,ùõΩ2
 - —Å–∫–æ—Ä–æ—Å—Ç–∏ –∑–∞—Ç—É—Ö–∞–Ω–∏—è –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –∏ –≤—Ç–æ—Ä–æ–≥–æ –º–æ–º–µ–Ω—Ç–æ–≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ;

ùë†
 - –æ—Ü–µ–Ω–∫–∞ –ø–µ—Ä–≤–æ–≥–æ –º–æ–º–µ–Ω—Ç–∞ (—Å—Ä–µ–¥–Ω–µ–µ) –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤;

ùë£
 - –æ—Ü–µ–Ω–∫–∞ –≤—Ç–æ—Ä–æ–≥–æ –º–æ–º–µ–Ω—Ç–∞ (–Ω–µ—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–∏—Å–ø–µ—Ä—Å–∏—è) –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤;

ùë°
 - —Ç–µ–∫—É—â–∞—è –∏—Ç–µ—Ä–∞—Ü–∏—è;

ùúñ
 - –º–∞–ª–µ–Ω—å–∫–æ–µ —á–∏—Å–ª–æ, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –¥–µ–ª–µ–Ω–∏—è –Ω–∞ 0.

import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D
‚Äã
# —Ü–µ–ª–µ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è
def objective(x1, x2):
    return x1**2 + x2**2
‚Äã
# –≥—Ä–∞–¥–∏–µ–Ω—Ç —Ü–µ–ª–µ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
def gradient(x1, x2):
    return np.array([2*x1, 2*x2])
‚Äã
# –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–º–µ–Ω—Ç–æ–≤
def init_adam():
    s = np.zeros(2)
    v = np.zeros(2)
    return s, v
‚Äã
# —à–∞–≥ Adam - –ø–µ—Ä–µ—Å—á–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
def adam_update_weights(x, grad, s, v, iteration, learning_rate, beta1, beta2, epsylon = 1e-8):
    s = beta1*s + (1 - beta1)*grad
    v = beta2*v + (1 - beta2)*(grad**2)
    s_hat = s / (1 - beta1**(iteration + 1))
    v_hat = v / (1 - beta2**(iteration + 1))
    x -= learning_rate * s_hat / (np.sqrt(v_hat) + epsylon)
    return x, s, v
‚Äã
# –∞–ª–≥–æ—Ä–∏—Ç–º Adam
def adam(objective, grad, bounds, max_iter, learning_rate, beta1, beta2, epsylon = 1e-8):
    # –Ω–∞—á–∞–ª—å–Ω–∞—è —Ç–æ—á–∫–∞
    x = bounds[:, 0] + np.random.rand(len(bounds))*(bounds[:, 1] - bounds[:, 0])
    score = objective(x[0], x[1])
    scores, trajectory = [], []
    # –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–º–µ–Ω—Ç–æ–≤
    s, v = init_adam()
    
    # –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Å–ø—É—Å–∫ Adam
    for _ in range(max_iter):
        # –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞
        grad = gradient(x[0], x[1])
        
        # –ø–µ—Ä–µ—Å—á–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
        x, s, v = adam_update_weights(x, grad, s, v, _, learning_rate, beta1, beta2, epsylon)
        
        # –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
        score = objective(x[0], x[1])
        scores.append(score)
        trajectory.append(x.copy())
        
        # print(">%d f(%s) = %.15f" % (_, x, score)) 
    return x, scores, trajectory
‚Äã
np.random.seed(12345678)
‚Äã
# –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≥—Ä–∞–Ω–∏—Ü
bounds = np.array([[-1.0, 1.0], [-1.0, 1.0]])
‚Äã
max_iter = 160
learning_rate = 0.01
beta1 = 0.8
beta2 = 0.999
‚Äã
# –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Å–ø—É—Å–∫ Adam
x_min, scores, trajectory = adam(objective, gradient, bounds, max_iter, learning_rate, beta1, beta2)
print("–ú–∏–Ω–∏–º—É–º –Ω–∞–π–¥–µ–Ω:")
print("f(%s) = %f" % (x_min, scores[-1]))
‚Äã
# –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
x = np.linspace(bounds[0, 0], bounds[0, 1], 100)
y = np.linspace(bounds[1, 0], bounds[1, 1], 100)
X, Y = np.meshgrid(x, y)
Z = objective(X, Y)
‚Äã
fig = plt.figure()
ax = fig.add_subplot(111, projection = "3d")
ax.plot_surface(X, Y, Z, cmap = 'viridis', alpha = 0.5)
ax.scatter(x_min[0], x_min[1], objective(x_min[0], x_min[1]), color = 'red', label = "–ú–∏–Ω–∏–º—É–º")
ax.plot([point[0] for point in trajectory], [point[1] for point in trajectory], scores, color = "blue", label = "–¢—Ä–∞–µ–∫—Ç–æ—Ä–∏—è")
ax.set_xlabel("x1")
ax.set_ylabel("x2")
ax.set_zlabel("f(x1, x2)")
ax.legend()
fig.show()
‚Äã
–ú–∏–Ω–∏–º—É–º –Ω–∞–π–¥–µ–Ω:
f([-9.86141076e-05  1.93822431e-09]) = 0.000000
C:\Users\vsoloviev\AppData\Local\Temp\ipykernel_12840\1664080860.py:83: UserWarning: Matplotlib is currently using module://matplotlib_inline.backend_inline, which is a non-GUI backend, so cannot show the figure.
  fig.show()

‚Äã
>0 f([ 0.34326042 -0.37804338]) = 0.26074
>1 f([ 0.27453625 -0.30924881]) = 0.17100
>2 f([ 0.19421614 -0.228584  ]) = 0.08997
>3 f([ 0.10889035 -0.14221215]) = 0.03208
>4 f([ 0.02585085 -0.05672143]) = 0.00389
>5 f([-0.04689446  0.02070929]) = 0.00263
>6 f([-0.10197447  0.08315473]) = 0.01731
>7 f([-0.13484511  0.12558593]) = 0.03396
>8 f([-0.1450838   0.14626277]) = 0.04244
>9 f([-0.13578162  0.14679985]) = 0.03999
>10 f([-0.11197782  0.13109868]) = 0.02973
>11 f([-0.07934515  0.10410414]) = 0.01713
>12 f([-0.04341111  0.0709296 ]) = 0.00692
>13 f([-0.00908183  0.03633538]) = 0.00140
>14 f([0.01974401 0.00438002]) = 0.00041
>15 f([ 0.04049811 -0.02185926]) = 0.00212
>16 f([ 0.05210055 -0.04048462]) = 0.00435
>17 f([ 0.05486753 -0.05082857]) = 0.00559
>18 f([ 0.05019851 -0.05332585]) = 0.00536
>19 f([ 0.04015966 -0.049245  ]) = 0.00404
>20 f([ 0.02707544 -0.04036108]) = 0.00236
>21 f([ 0.01318754 -0.02864135]) = 0.00099
>22 f([ 0.00039831 -0.01598289]) = 0.00026
>23 f([-0.00989794 -0.00401516]) = 0.00011
>24 f([-0.01689358  0.00603026]) = 0.00032
>25 f([-0.02035844  0.01338301]) = 0.00059
>26 f([-0.02055673  0.01773377]) = 0.00074
>27 f([-0.01811475  0.01918027]) = 0.00070
>28 f([-0.01386813  0.01813532]) = 0.00052
>29 f([-0.00871393  0.01521597]) = 0.00031
>30 f([-0.0034852   0.01113143]) = 0.00014
>31 f([0.00114122 0.00658319]) = 0.00004
>32 f([0.00469922 0.00218627]) = 0.00003
>33 f([ 0.00695077 -0.00158408]) = 0.00005
>34 f([ 0.0078709  -0.00441915]) = 0.00008
>35 f([ 0.00760856 -0.00617926]) = 0.00010
>36 f([ 0.00643304 -0.00687628]) = 0.00009
>37 f([ 0.00467574 -0.0066421 ]) = 0.00007
>38 f([ 0.00267579 -0.00568955]) = 0.00004
>39 f([ 0.00073552 -0.0042717 ]) = 0.00002
>40 f([-0.00091058 -0.00264476]) = 0.00001
>41 f([-0.0021121  -0.00103794]) = 0.00001
>42 f([-0.00280509  0.00036756]) = 0.00001
>43 f([-0.00300295  0.00144987]) = 0.00001
>44 f([-0.00277935  0.00214865]) = 0.00001
>45 f([-0.00224684  0.00245984]) = 0.00001
>46 f([-0.00153481  0.00242487]) = 0.00001
>47 f([-0.00076969  0.00211689]) = 0.00001
>48 f([-5.94348687e-05  1.62593061e-03]) = 0.00000
>49 f([0.00051648 0.00104521]) = 0.00000
>50 f([0.00091155 0.00045973]) = 0.00000
>51 f([ 1.11153634e-03 -6.19177562e-05]) = 0.00000
>52 f([ 0.0011299  -0.00047219]) = 0.00000
>53 f([ 0.00100056 -0.00074587]) = 0.00000
>54 f([ 0.00076947 -0.0008786 ]) = 0.00000
>55 f([ 0.00048641 -0.00088314]) = 0.00000
>56 f([ 0.00019785 -0.00078456]) = 0.00000
>57 f([-5.83071756e-05 -6.14841190e-04]) = 0.00000
>58 f([-0.00025584 -0.00040783]) = 0.00000
>59 f([-0.00038125 -0.00019495]) = 0.00000
>60 f([-4.32908473e-04 -2.00407550e-06]) = 0.00000
>61 f([-0.00041895  0.00015262]) = 0.00000
>62 f([-0.00035424  0.00025866]) = 0.00000
>63 f([-0.00025719  0.00031352]) = 0.00000
>64 f([-0.00014665  0.00032106]) = 0.00000
>65 f([-3.94373745e-05  2.89846586e-04]) = 0.00000
>66 f([5.13963033e-05 2.31234336e-04]) = 0.00000
>67 f([0.00011751 0.00015749]) = 0.00000
>68 f([1.55370072e-04 8.01992093e-05]) = 0.00000
>69 f([1.65780273e-04 9.03470666e-06]) = 0.00000
>70 f([ 1.52883836e-04 -4.89611239e-05]) = 0.00000
>71 f([ 1.22983466e-04 -8.96809526e-05]) = 0.00000
>72 f([ 8.33018188e-05 -1.11842410e-04]) = 0.00000
>73 f([ 4.08738807e-05 -1.16574315e-04]) = 0.00000
>74 f([ 1.68373938e-06 -1.06805354e-04]) = 0.00000
>75 f([-2.98923813e-05 -8.65654183e-05]) = 0.00000
>76 f([-5.13264122e-05 -6.02980563e-05]) = 0.00000
>77 f([-6.18942357e-05 -3.22616771e-05]) = 0.00000
>78 f([-6.24091916e-05 -6.07139804e-06]) = 0.00000
>79 f([-5.48116071e-05  1.55931856e-05]) = 0.00000
>80 f([-4.16955523e-05  3.11133301e-05]) = 0.00000
>81 f([-2.58459428e-05  3.99081762e-05]) = 0.00000
>82 f([-9.84326746e-06  4.22956299e-05]) = 0.00000
>83 f([4.22682001e-06 3.92763551e-05]) = 0.00000
>84 f([1.49426437e-05 3.22812857e-05]) = 0.00000
>85 f([2.15967855e-05 2.29192866e-05]) = 0.00000
>86 f([2.41446756e-05 1.27543013e-05]) = 0.00000
>87 f([2.30783009e-05 3.13206972e-06]) = 0.00000
>88 f([ 1.92561293e-05 -4.93325908e-06]) = 0.00000
>89 f([ 1.37197899e-05 -1.08113149e-05]) = 0.00000
>90 f([ 7.52369017e-06 -1.42525795e-05]) = 0.00000
>91 f([ 1.59688831e-06 -1.53416387e-05]) = 0.00000
>92 f([-3.35143674e-06 -1.44207725e-05]) = 0.00000
>93 f([-6.87943212e-06 -1.19986873e-05]) = 0.00000
>94 f([-8.81619054e-06 -8.65798781e-06]) = 0.00000
>95 f([-9.22978762e-06 -4.97243227e-06]) = 0.00000
>96 f([-8.37092068e-06 -1.44168343e-06]) = 0.00000
>97 f([-6.60425075e-06  1.55230731e-06]) = 0.00000
>98 f([-4.33872908e-06  3.76648931e-06]) = 0.00000
>99 f([-1.96608057e-06  5.09745817e-06]) = 0.00000
–†–µ–∑—É–ª—å—Ç–∞—Ç:
f([-1.96608057e-06  5.09745817e-06]) = 0.00000
C:\Users\vsoloviev\AppData\Local\Temp\ipykernel_8380\271599125.py:35: UserWarning: Matplotlib is currently using module://matplotlib_inline.backend_inline, which is a non-GUI backend, so cannot show the figure.
  fig.show()

–ó–∞–¥–∞–Ω–∏–µ

–ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∫–ª–∞—Å—Å –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ —Å–ø—É—Å–∫–∞ –¥–ª—è –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∞–ª–≥–æ—Ä–∏—Ç–º–∞ Adam. –°—Ä–∞–≤–Ω–∏—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è –∏ –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏ –¥–ª—è –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö videogames.
